

# Pacman All Manual -- Pacman 完全手册

### NAME

​		pacman ---- 包管理工具

### 概要

​		pacman <operation> [options] [targets]

​		pacman <操作>                [选项]       [目标]

### 描述

Pacman是一个软件包管理实用程序，可跟踪Linux上安装的软件包系统

它具有依赖项支持、软件包组、安装和卸载脚本，以及将本地计算机与远程存储库同步来自动升级软件包。Pacman软件包是压缩的tar格式。

调用pacman需要指定一个操作的选项和要操作的目标。目标通常是包名、文件名、URL或搜索字符串。目标可以作为命令行参数提供。此外，如果输入不是来自终端，而单个连字符（ - ）作为参数传递，则目标将从输入读取。



### OPERATIONS -- 操作

`-D, –databaes`

对包数据库进行操作。此操作允许您修改某些pacman数据库中已安装软件包的属性。它还允许您检查数据库的内部一致性。请参见下面的 Database 选项。

`-Q, --query`

查询软件包数据库。此操作允许您查看已安装的软件包及其文件，以及有关单个包的元信息（依赖关系，冲突，安装日期，构建日期，大小）。可以针对本地包数据库运行，也可以针对包文件单独使用。在第一种情况下，如果在命令行中未提供软件包名称，则将查询所有安装的软件包。另外，可以在包列表上应用各种过滤器。请参见下面的 Query 选项。

`-R, --remove`

从系统中删除软件包。还可以指定要删除的组，在这种情况下，该组中的每个包都将被删除。将删除属于指定软件包的文件，并将更新数据库。除非使用-nosave选项，否则大多数配置文件将使用.pacsave扩展名保存。请参阅下面的Remove选项。

`-S, --sync`

同步软件包。软件包直接从远程存储库中安装，包括运行软件包所需的所有依赖项。例如，pacman-S qt 将下载并安装 qt 及其所依赖的所有包。如果软件包名称存在于多个存储库中，可以指定存储库以明确要安装的软件包：pacman -S testing/qt. 您也可以指定版本要求： pacman -S "bash>=3.2". 注意！需要引号，否则shell将“>”解释为重定向到文件。

除了包之外，还可以指定组。例如，如果gnome是已定义的包组，pacman -S gnome.将提供一个提示，允许您从编号列表中选择要安装的软件包。使用space-和/或 逗号分隔 的软件包编号列表来指定软件包选择。可以通过指定连字符(`-`) 分隔第一个和最后一个软件包编号来选择顺序软件包。排除包是通过在数字或数字范围前面加上插入符号（`^`）来实现的。

包提供的其他的包也会被处理，例如，pacman-S foo 将首先寻找 foo 包。如果未找到foo 包，将搜索提供与foo相同功能的包。如果找到foo 包，将安装它。如果找到提供foo的多个包，则会提供选择提示。

您还可以使用`pacman-Su`升级所有过期的软件包。请参阅下面的同步选项。升级时，pacman执行版本比较以确定哪些软件包需要升级。此行为的操作如下：

Alphanumeric:
		 1.0a < 1.0b < 1.0beta < 1.0p < 1.0pre < 1.0rc < 1.0 < 1.0.a < 1.0.1
Numeric:
		 1 < 1.0 < 1.1 < 1.1.1 < 1.2 < 2.0 < 3.0.0

此外，版本字符串可以定义一个epoch value，该值将否决任何版本比较，除非epoch value相等。这是以 epoch:version-release 格式指定的。例如，2:1.0-1总是大于1:3.6-1。

`-T, --deptest`

检查依赖关系；这在诸如makepkg之类的脚本中很有用，可以检查已安装的软件包。此操作将检查指定的每个依赖项，并返回系统当前不满足的依赖项列表。此操作没有其他选项。示例用法：pacman -T qt "bash>=3.2".

`-U --upgrade`

升级或向系统添加软件包，并从同步存储库安装所需的依赖项。可以指定URL或文件路径。这是一个“先删除后添加”的过程。请参阅下面的Upgrade选项；另请参见Handling Config Files 以获取详细信息解释 pacman 如何处理配置文件的说明。

`-F, --files`

查询文件数据库。此操作允许您查找拥有某些文件的软件包或显示某些软件包拥有的文件。只搜索属于同步数据库的包。请参阅下面的File选项。

`-V, --version`

显示版本并退出。

`-h, --help`

显示给定operation的语法。如果未提供任何operation，则显示一般语法。

### OPTIONS -- 选项

`-b, --dbpath <path>`

指定替代数据库位置（默认为/var/lib/pacman）。除非您知道自己在做什么，否则不应使用此选项。注意：如果指定，这是一个绝对路径，并且根路径不会自动添加前缀。

`-r, --root <path>`

指定替代安装根目录（默认为/）。这不应用作将软件安装到/usr/local而不是/usr中的方法。注意: 如果在命令行或pacman.conf(5)中未指定数据库路径或日志文件路径，则其默认位置将在此根路径内。注意：此选项不适合在安装的来宾系统上执行操作。请参阅--sysroot.

`-v, --verbose`

输出路径，例如 Root、 Conf 文件、 DB 路径、 Cache Dirs 等。

`--arch <arch>`

指定替代体系架构。

`--cachedir <dir>`

指定替代软件包缓存位置（默认为/var/cache/pacman/pkg）。可以指定多个缓存目录，并按照将其传递给PACMAN的顺序进行尝试。注意：这是一个绝对路径，并且根路径不会自动预置。

`--color <when>`

指定何时启用着色。有效选项为“always”、“never”或“auto”。always使用颜色；never不使用颜色；auto仅在输出到tty上时自动启用颜色。

`--config <file>`

指定替代配置文件。

`--debug`

显示调试消息。报告错误时，建议使用此选项。

`--gpgdir <dir>`

指定 GnuPG 用于验证包签名的文件目录（默认为/etc/pacman.d/gnupg）。该目录应包含两个文件：pubring.gpg和trustdb.gpg。pubring.gpg 持有所有软件包的公共密钥。trustdb.gpg包含一个所谓的信任数据库，该数据库指定密钥是真实且值得信赖的。 注意：这是一个绝对路径，并且根路径不会自动预置。

`--hookdir <dir>`

指定包含hook文件的替代目录（默认为/etc/pacman.d/hooks）。可以在以后的目录中指定多个hook目录，后面目录中的hook优先于前面目录中的hook。注意：这是一个绝对路径,并且根路径不会自动预置。

`--logfile <file>`

指定备用日志文件。这是一个绝对路径，与安装根目录设置无关。

`--noconfirm`

绕过任何“Are you sure?”消息。除非您想从脚本中运行Pacman，否则这样做不是一个好主意。

`--confirm`

取消上一个--noconfirm的效果。

`--disable-download-timeout`

禁用下载时的低速限制和超时默认值。如果您在使用代理和/或安全网关下载文件时遇到问题，请使用此选项。

`--sysroot <dir>`

指定替代系统根目录。PACMAN将在运行之前将chroot和chdir进入系统根。这允许正确操作已安装的访客系统。给定的任何其他路径将被解释为相对于系统根目录。需要根目录特权。

### TRANSACTION OPTIONS (APPLY TO -S, -R AND -U) -- 事务选项(适用于  -S, -R 和 -U)

`-d, --nodeps`

跳过依赖性版本检查。仍将检查包名称。通常，pacman将始终检查包的依赖项字段，以确保安装了所有依赖项，并且系统中没有包冲突。指定此选项两次以跳过所有依赖项检查。

`--assume-installed <package=version>`

在事务中添加带有“version”版本的虚拟软件包“package”，以满足依赖关系。这允许在不影响所有依赖性检查的情况下禁用特定的依赖性检查。要禁用所有依赖项检查，请参见 --nodeps 选项。

`--dbonly`

仅添加/删除数据库条目，保留所有文件。

`--noprogressbar`

下载文件时不显示进度条。这对于调用pacman并捕获输出的脚本非常有用。

`--noscriptlet`

不执行可能存在的安装脚本。除非你知道自己在做什么，否则不要使用它。

`-p, --print`

只打印targets，而不执行实际操作(同步、删除或升级)。使用 --print-format 指定targets的显示方式。默认的格式字符串是"%l",它显示带有 -S 的 URL、带有 -U 的文件名和带有 -R 的 pkgname-pkgver。

`--print-format <format>`

指定一种类似printf的格式来控制--print操作的输出。

可能的属性有："%n" for pkgname,"%v" for pkgver,"%l" for location, "%r" for repository, and "%s" for size.Implies --print.

### UPGRADE OPTIONS (APPLY TO -S AND -U) -- 升级选项(适用于-S 和 -U)

`-w, --downloadonly`

从服务器中检索所有软件包，但不要安装/升级任何内容。

`--asdeps`

非显式安装软件包;换句话说，伪造他们的安装理由，将其作为依赖项安装。这对于makepkg和其他需要在构建包之前安装依赖项的源代码构建工具非常有用。

`--asexplicit`

显式安装软件包;换句话说，伪造他们的安装理由，不将其作为依赖项安装。如果您想将依赖项标记为显式安装，这样它就不会被 --recursive remove 操作删除，这将非常有用。

`--ignore <package>`

即使有可用的升级，也可以指示pacman忽略包的升级。可以通过用逗号分隔多个包来指定它们。

`--ignoregroup <group>`

即使有可用的升级，也可以指示pacman忽略组中所有软件包的升级。可以通过用逗号分隔多个组来指定它们。

`--needed`

不要重新安装已经是最新的目标。

`--overwrite <glob>`

绕过文件冲突检查并覆盖冲突文件。如果即将安装的软件包包含已经安装并与global匹配的文件,此选项将导致所有匹配的文件被覆盖。使用--overwrite将不允许用文件覆盖目录，也不允许安装文件和目录冲突的软件包。可以通过用逗号分隔多种模式。可以多次指定。模式可以被否定，这样匹配它们的文件将不会被覆盖，方法是在它们前面加一个感叹号。后续的匹配将覆盖前面的匹配。字面意思的感叹号或反斜杠需要转义。

### QUERY OPTIONS (APPLY TO -Q) -- 查询选项(适用于 -Q)

`-c, --changelog`

查看包的变更日志（如果存在）。

`-d, --deps`

限制或筛选作为依赖项安装的软件包的输出。此选项可以与-t组合使用，列出作为依赖项安装的孤立包,但是任何安装的软件包都不再需要。

> 孤立包是那些作为另一个包的依赖项，但缺少依赖于它们的父包的包。

`-e, --explicit`

限制或筛选输出作为显式安装的包。此选项可以与-t 组合使用，以列出任何其他包都不需要的显式安装的包。

`-g, --groups`

显示指定组成员的所有包。如果未指定名称，请列出所有分组的包。

`-i, --info`

显示给定包的信息。如果查询包文件而不是本地数据库，则可以使用-p选项。通过两个--info或-i标志也将显示备份文件及其修改状态的列表。

`-k, --check`

检查系统上给定包拥有的所有文件。如果未指定软件包或未提供过滤标志，则检查所有已安装的软件包。两次指定此选项将对包含所需 mtree 文件的包执行更详细的文件检查（包括权限，文件大小和修改时间）。

`-l, --list`

列出给定软件包拥有的所有文件。可以在命令行上指定多个软件包。

`-m, --foreign`

限制或筛选输出未在同步数据库中找到的软件包。通常这些软件包是手动下载并通过--upgrade安装的。

`-n, --native`

限制或筛选输出在同步数据库中找到的包。这是 --foreign 的反向筛选器

`-o, --owns <file>`

搜索拥有指定文件的包。路径可以是相对的或绝对的，可以指定一个或多个文件。

`-p, --file`

表示在命令行上提供的包是一个文件，而不是数据库中的一个条目。该文件将被解压缩并被查询。这与 --info和--list结合使用非常有用。

`-q, --quiet`

为某些查询操作显示较少的信息。这在脚本中处理pacman的输出时非常有用。

Search将只显示软件包名称，而不显示版本、组和描述信息;

owns将只显示包名，而不是“文件为包所有”消息；

group将仅显示包名称，并省略组名称；

list将仅显示文件并省略包名称；

check将仅显示成对的包名和丢失的文件；

裸查询只显示包名称，而不显示名称和版本。

`-s, --search <regexp>`

在每个本地安装的软件包中搜索与regexp匹配的名称或描述。当包含多个搜索关键词时,仅返回具有与所有这些条款相匹配的描述的软件包。

`-t, --unrequired`

限制或筛选输出，只打印当前安装的软件包既不是必需的也不是可选的包。

指定此选项两次，以包含另一个包可选但不是必需的的包。

`-u, --upgrades`

限制或筛选输出本地系统上过时的包。仅使用软件包版本来查找过时的软件包；此处不检查替代品。如果使用-Sy刷新同步数据库，则此选项效果最佳。

### REMOVE OPTIONS (APPLY TO -R) -- 删除选项 (适用于 -R)

`-c, --cascade`

删除所有目标包，以及依赖于一个或多个目标包的所有包。此操作是递归的，必须小心使用，因为它可以删除许多潜在需要的包。

`-n, --nosave`

指示pacman忽略文件备份名称。从系统中删除文件时，会检查数据库，以确定是否应使用.pacsave扩展名重命名该文件。

`-s, --recursive`

删除指定的每个目标，包括所有依赖项，前提是（a）其他软件包不需要它们；（b）用户没有明确安装它们。此操作是递归的，类似于向后的 --sync操作，它有助于保持一个没有孤立包的清洁系统。如果要省略条件（b），请将此选项传递两次。

`-u, --unneeded`

删除任何其他包都不需要的目标。这在不使用-c选项删除组时非常有用，以避免破坏任何依赖关系。

### SYNC OPTIONS (APPLY TO -S) -- 同步选项(适用于 -S)

`-c, --clean`

从缓存中删除不再安装的软件包以及当前未使用的同步数据库，以释放磁盘空间。当pacman下载包时，它会将它们保存在缓存目录中。此外，从中下载的每个同步数据库都会保存，即使从配置文件pacman.conf（5）中删除了数据库，也不会被删除。使用一个--clean选项仅删除不再安装的软件包；使用两个从缓存中删除所有文件。在这两种情况下，您都有一个是否选项来删除软件包和/或未使用的下载数据库。如果您使用网络共享缓存，请参见Pacman.conf（5）中的CleanMethod选项。

`-g, --groups`

显示指定的每个软件包组的所有成员。如果没有提供组名称，将列出所有组；将标志传递两次以查看所有组及其成员。

`-i, --info`

在给定同步数据库软件包上显示信息。传递两个 --info 或 -i 标志在所有依赖此软件包的存储库中显示这些软件包。

`-l, --list`

列出指定存储库中的所有软件包。可以在命令行上指定多个存储库。

`-q, --quiet`

为某些同步操作显示较少的信息。这在脚本中处理pacman的输出时非常有用。

Search将只显示包名，而不显示存储库、版本、组和描述信息；

list将仅显示包名，并省略数据库和版本；

group只显示包名，而忽略组名

`-s, --search <regexp>`

这将在同步数据库中的每个包中搜索与regexp匹配的名称或描述。当包含多个搜索项时，将只返回描述与所有这些项匹配的包。

`-u, --sysupgrade`

升级所有过时的软件包。如果存在较新的软件包，将检查和升级当前安装的包装。将介绍所有升级软件包的报告，并且未经用户确认的操作将不会进行。依赖关系在此级别自动解决，并在必要时安装/升级。

通过此选项两次，使软件包降级;在这种情况下，pacman将选择版本与本地版本不匹配的同步包。当用户从测试存储库切换到稳定的存储库时，这可能很有用。

也可以手动指定其他目标，例如：-Su -foo 将在同一操作中进行系统升级并安装/升级“foo”软件包。

`-y, --refresh`

从 pacman.conf （5）中定义的服务器下载主包数据库的新副本。这通常应该在每次使用 --sysupgrade 或-u时使用。传递两个--refresh或-y标志将强制刷新所有包数据库，即使它们看起来是最新的。

### DATABASE OPTIONS (APPLY TO -D) -- 数据库选项(适用于 -D)

`--asdeps <package>`

将软件包标记为非显式安装; 换句话说，将它们的安装原因设置为作为依赖项安装。

`--asexplicit <package>`

将软件包标记为显式安装；换句话说，将其安装原因设置为显式安装。如果您想保持安装包，即使它最初是作为另一个包的依赖项安装的，这也很有用。

`-k, --check`

检查本地包数据库是否内部一致。这将检查所有必需的文件是否存在，已安装的软件包是否具有必需的依赖项，是否不冲突，以及多个软件包是否不拥有同一个文件。两次指定此选项将对同步数据库执行检查，以确保所有指定的依赖项都可用。

`-q, --quiet`

在成功完成数据库操作时不显示消息。

### FILE OPTIONS (APPLY TO -F) -- 文件选项（适用于 -F）

`-y, --refresh`

从服务器下载新的包数据库。使用两次可强制刷新，即使数据库是最新的。

`-l, --list`

列出查询软件包拥有的文件。

`-x, --regex`

将每个查询解释为正则表达式。

`-q, --quiet`

为某些文件操作显示更少的信息。当pacman的输出在脚本中处理时，这很有用，但是，您可能希望使用--machinereadable 来取代。

`--machinereadable`

以机器可读的输出格式打印每个匹配。格式为：

`repository\0pkgname\0pkgver\0path\n`

其中\0为空字符，\n为换行符。

### HANDLING CONFIG FILES -- 处理配置文件

Pacman使用与rpm相同的逻辑来确定针对指定要备份的文件的操作。在升级过程中，每个备份文件使用三个MD5哈希值来确定所需的操作：

一个用于已安装的原始文件，一个用于即将安装的新文件，另一个用于文件系统上存在的实际文件。

比较这三个散列后，可能会出现以下情况：

`original=X, current=X, new=Y`

> original -> 已安装的原始文件，current -> 实际文件，new -> 即将安装的新文件

当前文件与原始文件相同，但新文件有所不同。由于用户从未修改该文件，并且新文件可能包含改进或错误修复，因此请安装新文件。

`original=X, current=Y, new=X`

两个包版本包含完全相同的文件，但文件系统上的文件已被修改。保留当前文件。

`original=X, current=Y, new=Y`

新文件与当前文件相同。安装新文件。

`original=X, current=Y, new=Z`

这三个文件都不同，因此安装扩展名为 .pacnew 的新文件并警告用户。然后，用户必须手动将任何必要的更改合并到现在安装的原始文件中。

`original=NULL, current=Y, new=Z`

该软件包以前未安装，文件系统上已存在该软件包。安装扩展名为.pacnew的新文件并警告用户。然后，用户必须手动将任何必要的更改合并到现在安装的原始文中。

### EXAMPLES -- 举例

`pacman -Ss ne.hack`

在软件包数据库中以正则表达式搜索“ ne.hack”。

`pacman -S gpm`

下载并安装gpm，包括依赖项。

`pacman -U /home/user/ceofhack-0.6-1-x86_64.pkg.tar.gz`

从本地文件安装 ceofhack-0.6-1软件包。

`pacman -Syu`

更新软件包列表，然后升级所有软件包。

`pacman -Syu gpm`

更新包列表，升级所有包，然后安装gpm（如果尚未安装）。

### CONFIGURATION -- 配置

有关使用pacman.conf文件配置PACMAN的更多详细信息，请参见PACMAN.CONF（5）。

### SEE ALSO -- 另见

alpm-hooks(5), libalpm(3), makepkg(8), pacman.conf(5)

请访问pacman网站：https://archlinux.org/pacman/有关pacman及其相关工具的最新信息

### BUGS -- 漏洞

漏洞？你一定是在开玩笑；此软件中没有错误。但如果我们碰巧错了，请在的Arch Linux bug Tracker的Pacman板块上提交一份包含尽可能多细节的bug报告。

### AUTHORS -- 作者

目前的维护人员:

       Judd Vinet <jvinet@zeroflux.org>
    
       Aurelien Foret <aurelien@archlinux.org>
    
       Aaron Griffin <aaron@archlinux.org>
    
       Dan McGee <dan@archlinux.org>
    
       Xavier Chantry <shiningxc@gmail.com>
    
       Nagy Gabor <ngaba@bibl.u-szeged.hu>
    
       Dave Reisner <dreisner@archlinux.org>

对于其他贡献者，请在 pacman.git 存储库中使用 ` git short log-s`。

Pacman 6.0.1					2022-05-01					 PACMAN(8)